<div class="background"></div>
<div class="form-container">
  <form (ngSubmit)="submit()" (keydown.enter)="$event.preventDefault()" #f="ngForm">
  <div class="roof-form" [ngClass]="'step-' + currentStep">
    <div class="header">
      <img [src]="logoUrl" alt="Form Logo" class="form-logo">
      <h1>{{ formTitle }}</h1>
    </div>
    <div class="questions" *ngIf="currentStep === 1">
      <div class="question">
        <label for="make">Choose your car make</label>
        <select id="make" [(ngModel)]="currentVehicle.make" name="make" (change)="onMakeChange()" required>
          <option value="">Select a make</option>
          <option *ngFor="let make of vehicleDataService.makes" [value]="make">{{ make }}</option>
        </select>
        <div class="error" *ngIf="errors['make']">{{ errors['make'] }}</div>
      </div>
      <div class="question">
        <label for="model">Choose your car model</label>
        <select id="model" [(ngModel)]="currentVehicle.model" name="model" (change)="onModelChange()" required [disabled]="!currentVehicle.make">
          <option value="">Select a model</option>
          <option *ngFor="let model of availableModels" [value]="model">{{ model }}</option>
        </select>
        <div class="error" *ngIf="errors['model']">{{ errors['model'] }}</div>
      </div>
      <div class="question">
        <label for="submodel">Choose your car submodel</label>
        <select id="submodel" [(ngModel)]="currentVehicle.submodel" name="submodel" (change)="onSubmodelChange()" required [disabled]="!currentVehicle.model">
          <option value="">Select a submodel</option>
          <option *ngFor="let submodel of availableSubmodels" [value]="submodel">{{ submodel }}</option>
        </select>
        <div class="error" *ngIf="errors['submodel']">{{ errors['submodel'] }}</div>
      </div>
      <div class="question">
        <label for="year">Choose your car year</label>
        <select id="year" [(ngModel)]="currentVehicle.year" name="year" required [disabled]="!currentVehicle.submodel">
          <option value="">Select a year</option>
          <option *ngFor="let year of availableYears" [value]="year">{{ year }}</option>
        </select>
        <div class="error" *ngIf="errors['year']">{{ errors['year'] }}</div>
      </div>
    </div>
    <div class="questions" *ngIf="currentStep === 2">
      <div class="question">
        <label for="coverage_type">Choose your coverage type</label>
        <select id="coverage_type" [(ngModel)]="currentVehicle.coverage_type" name="coverage_type" required>
          <option value="">Select coverage type</option>
          <option value="Preferred">Preferred</option>
          <option value="Premium">Premium</option>
          <option value="Standard">Standard</option>
          <option value="State Minimum">State Minimum</option>
        </select>
        <div class="error" *ngIf="errors['coverage_type']">{{ errors['coverage_type'] }}</div>
        </div>
      <div class="question">
        <label for="garage">Where is your car parked?</label>
        <select id="garage" [(ngModel)]="currentVehicle.garage" name="garage" required>
          <option value="">Select parking location</option>
          <option value="Car Port">Car Port</option>
          <option value="Full Garage">Full Garage</option>
          <option value="No Cover">No Cover</option>
          <option value="On Street">On Street</option>
        </select>
        <div class="error" *ngIf="errors['garage']">{{ errors['garage'] }}</div>
        </div>
      <div class="question">
        <label for="ownership">Ownership type</label>
        <select id="ownership" [(ngModel)]="currentVehicle.ownership" name="ownership" required>
          <option value="">Select ownership</option>
          <option value="Own">Own</option>
          <option value="Lease">Lease</option>
          <option value="Finance">Finance</option>
        </select>
        <div class="error" *ngIf="errors['ownership']">{{ errors['ownership'] }}</div>
        </div>
    </div>
    <div class="questions" *ngIf="currentStep === 3">
      <div class="question">
        <label for="primary_use">Primary use of the vehicle</label>
        <select id="primary_use" [(ngModel)]="currentVehicle.primary_use" name="primary_use" required>
          <option value="">Select primary use</option>
          <option value="Business">Business</option>
          <option value="Commute School">Commute School</option>
          <option value="Commute Varies">Commute Varies</option>
          <option value="Commute Work">Commute Work</option>
          <option value="Pleasure">Pleasure</option>
        </select>
        <div class="error" *ngIf="errors['primary_use']">{{ errors['primary_use'] }}</div>
      </div>
      <div class="question">
        <label for="annual_miles">Annual mileage</label>
        <select id="annual_miles" [(ngModel)]="currentVehicle.annual_miles" name="annual_miles" required>
          <option value="">Select annual miles</option>
          <option value="Under 5,000">Under 5,000</option>
          <option value="5,001 - 10,000">5,001 - 10,000</option>
          <option value="10,001 - 15,000">10,001 - 15,000</option>
          <option value="15,000+">15,000+</option>
        </select>
        <div class="error" *ngIf="errors['annual_miles']">{{ errors['annual_miles'] }}</div>
      </div>
      <div class="question">
        <label for="currently_insured">Are you currently insured?</label>
        <select id="currently_insured" [(ngModel)]="currentVehicle.currently_insured" name="currently_insured" required>
          <option value="">Select</option>
          <option value="Yes">Yes</option>
          <option value="No">No</option>
        </select>
        <div class="error" *ngIf="errors['currently_insured']">{{ errors['currently_insured'] }}</div>
      </div>
    </div>
    <div class="questions" *ngIf="currentStep === 4">
      <div class="question">
        <label for="add_another">Add another vehicle?</label>
        <select id="add_another" [(ngModel)]="addAnotherVehicle" name="add_another" required>
          <option value="">Select</option>
          <option value="Yes">Yes</option>
          <option value="No">No</option>
        </select>
        <div class="error" *ngIf="errors['add_another']">{{ errors['add_another'] }}</div>
      </div>
    </div>
    <div class="questions" *ngIf="currentStep === 6">
      <div class="question">
        <label for="license_state">License State</label>
        <select id="license_state" [(ngModel)]="license_state" name="license_state" required>
          <option value="">Select a state</option>
          <option value="AL">Alabama</option>
          <option value="AK">Alaska</option>
          <option value="AZ">Arizona</option>
          <option value="AR">Arkansas</option>
          <option value="CA">California</option>
          <option value="CO">Colorado</option>
          <option value="CT">Connecticut</option>
          <option value="DE">Delaware</option>
          <option value="DC">Washington DC</option>
          <option value="FL">Florida</option>
          <option value="GA">Georgia</option>
          <option value="HI">Hawaii</option>
          <option value="ID">Idaho</option>
          <option value="IL">Illinois</option>
          <option value="IN">Indiana</option>
          <option value="IA">Iowa</option>
          <option value="KS">Kansas</option>
          <option value="KY">Kentucky</option>
          <option value="LA">Louisiana</option>
          <option value="ME">Maine</option>
          <option value="MD">Maryland</option>
          <option value="MA">Massachusetts</option>
          <option value="MI">Michigan</option>
          <option value="MN">Minnesota</option>
          <option value="MS">Mississippi</option>
          <option value="MO">Missouri</option>
          <option value="MT">Montana</option>
          <option value="NE">Nebraska</option>
          <option value="NV">Nevada</option>
          <option value="NH">New Hampshire</option>
          <option value="NJ">New Jersey</option>
          <option value="NM">New Mexico</option>
          <option value="NY">New York</option>
          <option value="NC">North Carolina</option>
          <option value="ND">North Dakota</option>
          <option value="OH">Ohio</option>
          <option value="OK">Oklahoma</option>
          <option value="OR">Oregon</option>
          <option value="PA">Pennsylvania</option>
          <option value="PR">Puerto Rico</option>
          <option value="RI">Rhode Island</option>
          <option value="SC">South Carolina</option>
          <option value="SD">South Dakota</option>
          <option value="TN">Tennessee</option>
          <option value="TX">Texas</option>
          <option value="UT">Utah</option>
          <option value="VT">Vermont</option>
          <option value="VI">Virgin Islands</option>
          <option value="VA">Virginia</option>
          <option value="WA">Washington</option>
          <option value="WV">West Virginia</option>
          <option value="WI">Wisconsin</option>
          <option value="WY">Wyoming</option>
        </select>
        <div class="error" *ngIf="errors['license_state']">{{ errors['license_state'] }}</div>
      </div>
      <div class="question">
        <label for="license_status">License Status</label>
        <select id="license_status" [(ngModel)]="license_status" name="license_status" required>
          <option value="">Select status</option>
          <option value="Active">Active</option>
          <option value="International">International</option>
          <option value="Learner">Learner</option>
          <option value="Probation">Probation</option>
          <option value="Restricted">Restricted</option>
          <option value="Suspended">Suspended</option>
          <option value="Temporary">Temporary</option>
        </select>
        <div class="error" *ngIf="errors['license_status']">{{ errors['license_status'] }}</div>
      </div>
    </div>
    <div class="questions" *ngIf="currentStep === 5">
      <h3>Vehicle Summary</h3>
      <div *ngFor="let vehicle of vehicles; let i = index" class="vehicle-preview">
        <h4>Vehicle {{ i + 1 }}</h4>
        <p><strong>Make:</strong> {{ vehicle.make }}</p>
        <p><strong>Model:</strong> {{ vehicle.model }}</p>
        <p><strong>Submodel:</strong> {{ vehicle.submodel }}</p>
        <p><strong>Year:</strong> {{ vehicle.year }}</p>
        <p><strong>Coverage Type:</strong> {{ vehicle.coverage_type }}</p>
        <p><strong>Garage:</strong> {{ vehicle.garage }}</p>
        <p><strong>Ownership:</strong> {{ vehicle.ownership }}</p>
        <p><strong>Primary Use:</strong> {{ vehicle.primary_use }}</p>
        <p><strong>Annual Miles:</strong> {{ vehicle.annual_miles }}</p>
        <p><strong>Currently Insured:</strong> {{ vehicle.currently_insured }}</p>
      </div>
    </div>
    <div class="questions" *ngIf="currentStep === 7">
      <div class="question">
        <label for="date_of_birth">Date of Birth</label>
        <input type="date" id="date_of_birth" [(ngModel)]="date_of_birth" name="date_of_birth" required [max]="maxDate">
        <div class="error" *ngIf="errors['date_of_birth']">{{ errors['date_of_birth'] }}</div>
      </div>
    </div>
    <div class="questions" *ngIf="currentStep === 11">
      <div class="question">
        <label for="first_name">First Name</label>
        <input type="text" id="first_name" [(ngModel)]="first_name" name="first_name" required (input)="onFirstNameInput()">
        <div class="error" *ngIf="errors['first_name']">{{ errors['first_name'] }}</div>
      </div>
      <div class="question">
        <label for="last_name">Last Name</label>
        <input type="text" id="last_name" [(ngModel)]="last_name" name="last_name" required (input)="onLastNameInput()">
        <div class="error" *ngIf="errors['last_name']">{{ errors['last_name'] }}</div>
      </div>
    </div>
    <div class="questions" *ngIf="currentStep === 12">
      <div class="question">
        <label for="email">Email</label>
        <input type="email" id="email" [(ngModel)]="email" name="email" required>
        <div class="error" *ngIf="errors['email']">{{ errors['email'] }}</div>
      </div>
      <div class="question">
        <label for="phone">Phone</label>
        <input type="tel" id="phone" [(ngModel)]="phone" name="phone" required maxlength="10" pattern="[0-9]{10}" (input)="onPhoneInput()">
        <div class="error" *ngIf="errors['phone']">{{ errors['phone'] }}</div>
      </div>
    </div>
    <div class="questions" *ngIf="currentStep === 13">
      <div class="question">
        <label for="state">State</label>
        <select id="state" [(ngModel)]="state" name="state" required>
          <option value="">Select a state</option>
          <option value="AL">Alabama</option>
          <option value="AK">Alaska</option>
          <option value="AZ">Arizona</option>
          <option value="AR">Arkansas</option>
          <option value="CA">California</option>
          <option value="CO">Colorado</option>
          <option value="CT">Connecticut</option>
          <option value="DE">Delaware</option>
          <option value="DC">Washington DC</option>
          <option value="FL">Florida</option>
          <option value="GA">Georgia</option>
          <option value="HI">Hawaii</option>
          <option value="ID">Idaho</option>
          <option value="IL">Illinois</option>
          <option value="IN">Indiana</option>
          <option value="IA">Iowa</option>
          <option value="KS">Kansas</option>
          <option value="KY">Kentucky</option>
          <option value="LA">Louisiana</option>
          <option value="ME">Maine</option>
          <option value="MD">Maryland</option>
          <option value="MA">Massachusetts</option>
          <option value="MI">Michigan</option>
          <option value="MN">Minnesota</option>
          <option value="MS">Mississippi</option>
          <option value="MO">Missouri</option>
          <option value="MT">Montana</option>
          <option value="NE">Nebraska</option>
          <option value="NV">Nevada</option>
          <option value="NH">New Hampshire</option>
          <option value="NJ">New Jersey</option>
          <option value="NM">New Mexico</option>
          <option value="NY">New York</option>
          <option value="NC">North Carolina</option>
          <option value="ND">North Dakota</option>
          <option value="OH">Ohio</option>
          <option value="OK">Oklahoma</option>
          <option value="OR">Oregon</option>
          <option value="PA">Pennsylvania</option>
          <option value="PR">Puerto Rico</option>
          <option value="RI">Rhode Island</option>
          <option value="SC">South Carolina</option>
          <option value="SD">South Dakota</option>
          <option value="TN">Tennessee</option>
          <option value="TX">Texas</option>
          <option value="UT">Utah</option>
          <option value="VT">Vermont</option>
          <option value="VI">Virgin Islands</option>
          <option value="VA">Virginia</option>
          <option value="WA">Washington</option>
          <option value="WV">West Virginia</option>
          <option value="WI">Wisconsin</option>
          <option value="WY">Wyoming</option>
        </select>
        <div class="error" *ngIf="errors['state']">{{ errors['state'] }}</div>
      </div>
      <div class="question">
        <label for="zip">Zip Code</label>
        <input type="text" id="zip" [(ngModel)]="zip" name="zip" required maxlength="5" pattern="[0-9]{5}" (input)="onZipInput()">
        <div class="error" *ngIf="errors['zip']">{{ errors['zip'] }}</div>
      </div>
    </div>
    <div class="questions" *ngIf="currentStep === 14">
      <div class="question">
        <label for="city">City</label>
        <input type="text" id="city" [(ngModel)]="city" name="city" required>
        <div class="error" *ngIf="errors['city']">{{ errors['city'] }}</div>
      </div>
      <div class="question">
        <label for="street_address">Street Address</label>
        <input type="text" id="street_address" [(ngModel)]="street_address" name="street_address" required>
        <div class="error" *ngIf="errors['street_address']">{{ errors['street_address'] }}</div>
      </div>
    </div>
    <div class="questions" *ngIf="currentStep === 8">
      <div class="question">
        <label for="marital_status">Marital Status</label>
        <select id="marital_status" [(ngModel)]="marital_status" name="marital_status" required>
          <option value="">Select status</option>
          <option value="Single">Single</option>
          <option value="Married">Married</option>
          <option value="Divorced">Divorced</option>
          <option value="Separated">Separated</option>
          <option value="Widowed">Widowed</option>
          <option value="Domestic Partner">Domestic Partner</option>
        </select>
        <div class="error" *ngIf="errors['marital_status']">{{ errors['marital_status'] }}</div>
      </div>
      <div class="question">
        <label for="education">Education</label>
        <select id="education" [(ngModel)]="education" name="education" required>
          <option value="">Select education</option>
          <option value="High School Diploma">High School Diploma</option>
          <option value="Associate Degree">Associate Degree</option>
          <option value="BS">BS</option>
          <option value="MS">MS</option>
          <option value="Some College">Some College</option>
          <option value="Some or no High School">Some or no High School</option>
          <option value="Less than High School">Less than High School</option>
        </select>
        <div class="error" *ngIf="errors['education']">{{ errors['education'] }}</div>
      </div>
    </div>
    <div class="questions" *ngIf="currentStep === 9">
      <div class="question">
        <label for="tickets_past_12_months">Any tickets in past 12 months</label>
        <select id="tickets_past_12_months" [(ngModel)]="tickets_past_12_months" name="tickets_past_12_months" required>
          <option value="">Select</option>
          <option value="Yes">Yes</option>
          <option value="No">No</option>
        </select>
        <div class="error" *ngIf="errors['tickets_past_12_months']">{{ errors['tickets_past_12_months'] }}</div>
      </div>
      <div class="question" *ngIf="tickets_past_12_months === 'Yes'">
        <label for="num_tickets">No of tickets</label>
        <select id="num_tickets" [(ngModel)]="num_tickets" name="num_tickets" required>
          <option value="">Select</option>
          <option value="1">1</option>
          <option value="2">2</option>
          <option value="3">3</option>
        </select>
        <div class="error" *ngIf="errors['num_tickets']">{{ errors['num_tickets'] }}</div>
      </div>
      <div class="question">
        <label for="major_violations_past_12_months">Any major violations in past 12 months</label>
        <select id="major_violations_past_12_months" [(ngModel)]="major_violations_past_12_months" name="major_violations_past_12_months" required>
          <option value="">Select</option>
          <option value="Yes">Yes</option>
          <option value="No">No</option>
        </select>
        <div class="error" *ngIf="errors['major_violations_past_12_months']">{{ errors['major_violations_past_12_months'] }}</div>
      </div>
      <div class="question" *ngIf="major_violations_past_12_months === 'Yes'">
        <label for="num_major_violations">No of major violations</label>
        <select id="num_major_violations" [(ngModel)]="num_major_violations" name="num_major_violations" required>
          <option value="">Select</option>
          <option value="1">1</option>
          <option value="2">2</option>
          <option value="3">3</option>
        </select>
        <div class="error" *ngIf="errors['num_major_violations']">{{ errors['num_major_violations'] }}</div>
      </div>
    </div>
    <div class="questions" *ngIf="currentStep === 10">
      <div class="question">
        <label for="accidents_past_12_months">Any accidents in past 12 months</label>
        <select id="accidents_past_12_months" [(ngModel)]="accidents_past_12_months" name="accidents_past_12_months" required>
          <option value="">Select</option>
          <option value="Yes">Yes</option>
          <option value="No">No</option>
        </select>
        <div class="error" *ngIf="errors['accidents_past_12_months']">{{ errors['accidents_past_12_months'] }}</div>
      </div>
      <div class="question" *ngIf="accidents_past_12_months === 'Yes'">
        <label for="num_accidents">No of accidents</label>
        <select id="num_accidents" [(ngModel)]="num_accidents" name="num_accidents" required>
          <option value="">Select</option>
          <option value="1">1</option>
          <option value="2">2</option>
          <option value="3">3</option>
        </select>
        <div class="error" *ngIf="errors['num_accidents']">{{ errors['num_accidents'] }}</div>
      </div>
      <div class="question">
        <label for="claims_past_12_months">Any claims in past 12 months</label>
        <select id="claims_past_12_months" [(ngModel)]="claims_past_12_months" name="claims_past_12_months" required>
          <option value="">Select</option>
          <option value="Yes">Yes</option>
          <option value="No">No</option>
        </select>
        <div class="error" *ngIf="errors['claims_past_12_months']">{{ errors['claims_past_12_months'] }}</div>
      </div>
      <div class="question" *ngIf="claims_past_12_months === 'Yes'">
        <label for="num_claims">No of claims</label>
        <select id="num_claims" [(ngModel)]="num_claims" name="num_claims" required>
          <option value="">Select</option>
          <option value="1">1</option>
          <option value="2">2</option>
          <option value="3">3</option>
        </select>
        <div class="error" *ngIf="errors['num_claims']">{{ errors['num_claims'] }}</div>
      </div>
    </div>
    <div class="questions" *ngIf="currentStep === 15">
      <div class="question">
        <label for="agreement" class="checkbox-label">
          <input type="checkbox" id="agreement" [(ngModel)]="agreement" name="agreement">
          By clicking GET YOUR QUOTE, I agree to the <a href="/policies?tab=privacy" target="_blank">Terms of Service and Privacy Policy</a>, I authorize auto insurance companies, their contractors, and <a href="/marketing-partners" target="_blank">Partner Companies</a> to contact me about auto insurance offers by phone calls and text messages to the number I provided. I authorize that these marketing communications may be delivered to me using an automatic telephone dialing system or by prerecorded message. I understand that my consent is not a condition of purchase, and I may revoke that consent at any time. Mobile and data charges may apply. <a href="/policies?tab=company" target="_blank">California Residents</a>.
        </label>
        <div class="error" *ngIf="errors['agreement']">{{ errors['agreement'] }}</div>
      </div>
      <input type="hidden" name="ipaddress" [(ngModel)]="ipaddress">
      <input id="leadid_token" name="universal_leadid" type="hidden">
    </div>

    <div class="error" *ngIf="errors['general']" style="text-align: center;">{{ errors['general'] }}</div>
    <div class="buttons" [ngClass]="{'multiple': currentStep !== 1}">
      <button *ngIf="currentStep === 1" type="button" (click)="nextStep()" class="btn-next">Next</button>
      <button *ngIf="currentStep > 1 && currentStep < totalSteps" type="button" (click)="previousStep()" class="btn-previous">Previous</button>
      <button *ngIf="currentStep > 1 && currentStep < totalSteps" type="button" (click)="nextStep()" class="btn-next" [disabled]="isValidatingIP || isValidatingZip">
        <span *ngIf="!isValidatingIP && !isValidatingZip">Next</span>
        <span *ngIf="isValidatingIP">Validating...</span>
        <span *ngIf="isValidatingZip">Validating Zip...</span>
      </button>
      <button *ngIf="currentStep === totalSteps" type="button" (click)="previousStep()" class="btn-previous">Previous</button>
      <button *ngIf="currentStep === totalSteps" type="submit" class="btn-submit" [disabled]="!isUSCitizen || isSubmitting">
        <span *ngIf="!isSubmitting">Submit</span>
        <span *ngIf="isSubmitting">Submitting...</span>
      </button>
    </div>
  </div>
  </form>
</div>


<div *ngIf="showThankYou" class="thank-you-popup">
  Thank you, your response has been recorded.
</div>

<noscript><img src='//create.leadid.com/noscript.gif?lac=6B96394A-E3F0-75F4-8748-80CB63C352C2&lck=548c86c2-3c24-2ec2-b201-274ffb0f5005&snippet_version=2' /></noscript>